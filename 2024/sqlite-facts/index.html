<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=generator content="Hugo 0.139.4"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta property="og:url" content="https://avi.im/blag/2024/sqlite-facts/"><title>Collection of insane and fun facts about SQLite - blag</title>
<meta property="og:title" content="Collection of insane and fun facts about SQLite - blag"><meta property="og:type" content="article"><meta property="og:description" content="Some of the interesting and insane facts I learned about SQLite"><meta name=description content="Some of the interesting and insane facts I learned about SQLite"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Arvo:400,700"><link rel=stylesheet href=/blag/css/highlight.css><link rel=stylesheet href=/blag/css/journal.css><link href=/blag/index.xml rel=alternate type=application/rss+xml title=blag></head><body><div class=container><div class=site-header-nav><nav class=site-nav><a href=https://avi.im/blag/>Index</a></nav><div><span><a href=/blag/about>About</a></span>
<span><a href=/blag/now>Now</a></span></div></div><article class=post><header class=post-header><h1 class=post-title>Collection of insane and fun facts about SQLite</h1><time class=post-date datetime="2024-12-30 15:23:57 +0530">30 Dec 2024</time></header><ol><li><p>SQLite is the most deployed and most used database. There are over one trillion (1000000000000 or a million million) SQLite databases in active use.</p><p>It is maintained by <a href=https://www.sqlite.org/crew.html>three people</a>. They don&rsquo;t allow outside contributions.</p></li><li><p>SQLite is likely used more than all other database engines combined. Billions and billions of copies of SQLite exist in the wild. It&rsquo;s everywhere.</p><img src=/blag/images/2024/sqlite-fact-1.png style=width:75%></li><li><p>It is also probably one of the top five most deployed software modules.</p><img src=/blag/images/2024/sqlite-fact-2.png style=width:75%></li><li><p><a href=https://hwaci.com>Hwaci</a> is the company behind SQLite. They are also into music(?)</p><p><img src=/blag/images/2024/sqlite-fact-3.png style=width:65%></p></li><li><p>SQLite originated from a US warship. D. Richard Hipp (DRH) was building software for the USS Oscar Austin, a Navy destroyer. The existing software would just stop working whenever the server went down (this was in the 2000s). For a battleship, this was unacceptable.</p><p>So DRH asked the question: what if the database just worked without any server? In DRH words:</p><blockquote><p>Why do we even need a server? Why can’t I pull this directly off the disk drive? That way if the computer is healthy enough, it can run our application at all, we don’t have dependencies that can fail and cause us to fail, and I looked around and there were no SQL database engines that would do that, and one of the guys I was working with says, “Richard, why don’t you just write one?” “Okay, I’ll give it a try.” I didn’t do that right away, but later on, it was a funding hiatus. This was back in 2000, and if I recall correctly, Newt Gingrich and Bill Clinton were having a fight of some sort, so all government contracts got shut down, so I was out of work for a few months, and I thought, “Well, I’ll just write that database engine now.”</p></blockquote></li><li><p>Unlike most open source project that uses standard licenses (like MIT or GPL), SQLite does not come with a OSI-approved license.</p><img src=/blag/images/2024/sqlite-fact-4.png style=width:75%><p>Instead, SQLite is released into the public domain and it has even fewer restrictions.</p><p>Also note that this can be a <a href=https://opensource.org/blog/public-domain-is-not-open-source>problem</a> in some countries/jurisdictions where public domain is not recognized. Hence, SQLite <a href=https://www.sqlite.org/purchase/license>sells licenses</a>, called &lsquo;Warranty of Title&rsquo;.</p></li><li><p>They don&rsquo;t allow outside contributions. You <em>cannot</em> just send a pull request and hope the patch will be accepted.</p><img src=/blag/images/2024/sqlite-fact-5.png style=width:75%></li><li><p>Open Source, Not Open Contribution</p><img src=/blag/images/2024/sqlite-fact-6.png style=width:75%><p>Contributing to SQLite is invite-only (I don&rsquo;t have a source). Only after you are invited and have signed an affidavit dedicating your contribution to the public domain can you submit patches.</p></li><li><p>How do they cook?</p><p>There are over 600 lines of test code for every line of code in SQLite. Tests cover 100% of branches (and 100% <a href=https://en.wikipedia.org/wiki/Modified_condition/decision_coverage>MC/DC</a>) in the library. The test suite is extremely diverse, including fuzz tests, boundary value tests, regression tests, and tests that simulate operating system crashes, power losses, I/O errors, and out-of-memory errors.</p></li><li><p>Interestingly, some SQLite tests are proprietary. The test suite called <a href=https://www.sqlite.org/th3.html>TH3 (Test Harness 3)</a>, which achieves 100% branch coverage of the code, is proprietary and is not open to access.</p><p>I don&rsquo;t know any other project which has made code free, but test suites are paid.</p><p>However, they could not sell a single copy of TH3. DRH said in a podcast:</p><blockquote><p>The 100% MCD tests, that’s called TH3. That’s proprietary. I had the idea that we would sell those tests to avionics manufacturers and make money that way. We’ve sold exactly zero copies of that so that didn’t really work out.</p></blockquote><p>In order to get access, one needs to be part of SQLite Consortium, which costs $120K/yearly.</p></li><li><p>It&rsquo;s an interesting business model. They generate revenue through licenses, paid support, maintenance services, consortium membership, and commercial extensions.</p></li><li><p>SQLite does not have a Code of Conduct (CoC), rather <a href=https://sqlite.org/codeofethics.html>Code of Ethics</a> derived from &ldquo;instruments of good works&rdquo; from chapter 4 of The Rule of St. Benedict</p><img src=/blag/images/2024/sqlite-coe.png></li><li><p>In SQLite: In place of a legal notice, here is a <a href=https://github.com/sqlite/sqlite/blob/624cb96/src/wal.c#L4,#L9>blessing</a>:</p><img src=/blag/images/2024/sqlite-fact-11.jpeg style=width:75%><p>All the of the source code files come with a blessing.</p></li><li><p>SQLite is so fast, they compete with <code>fopen</code>. For some use cases, you can use SQLite instead of a filesystem, that can be 35% faster.</p><img src=/blag/images/2024/sqlite-fact-7.png style=width:75%></li><li><p>SQLite vs Redis (guess which is faster?)</p><img src=/blag/images/2024/sqlite-fact-8.png style=width:65%><p>For <a href=https://x.com/iavins/status/1849422515027763227>some usecases</a>, the SQLite can be faster than Redis due to network stack and (de)serialisation overhead.</p></li><li><p>But, unlike most databases, SQLite has a single writer model. You cannot have more than one concurrent writer.</p><p>This was also changed recently in 2010 by adding WAL mode. Before that, you could have either readers or a writer, but never together.</p></li><li><p>There are other things which are very common in other databases but not in SQLite:</p><ul><li>The default is rollback journal mode, which restricts you to have either multiple readers or a single writer</li><li>Foreign Keys are disabled; they are opt-in</li><li>It is &ldquo;weakly typed&rdquo;. SQLite calls it &ldquo;type affinity&rdquo;. Meaning you can insert whatever in a column even though you have defined a type. Strong typed columns are opt-in (by <a href=https://www.sqlite.org/stricttables.html><code>STRICT</code></a> tables).</li><li><a href=https://sqlite.org/omitted.html>Many of the <code>ALTER</code> commands</a> you expect in other databases don&rsquo;t work. For example, you cannot add a contraint to an existing column. (They recently added ability to rename a column name)</li></ul><p>There is a whole <a href=https://www.sqlite.org/quirks.html>list of quirks</a> here.</p></li><li><p>I hate that it doesn&rsquo;t have types. It&rsquo;s totally YOLO:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> <span style=color:#66d9ef>user</span>(id INTEGER);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>into</span> <span style=color:#66d9ef>user</span> <span style=color:#66d9ef>VALUES</span> (<span style=color:#e6db74>&#34;YOLO!&#34;</span>); <span style=color:#75715e>--- This works!
</span></span></span></code></pre></div><p>Not only that, it does not throw any error if you give some random type.</p><p><code>CREATE TABLE t(value TIMMYSTAMP);</code></p><p>There is no <code>TIMMYSTAMP</code> type, but SQLite accepts this happily.</p><p>SQLite has five types: <code>NULL</code>, <code>INTEGER</code>, <code>REAL</code>, <code>TEXT</code>, <code>BLOB</code>. Want to know something cursed? The type affinity works by <a href=https://www.sqlite.org/datatype3.html#determination_of_column_affinity>substring match</a>!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> t(value SPONGEBLOB) <span style=color:#75715e>--- This is BLOB type!
</span></span></span></code></pre></div><p>So yeah, this happens too:</p><blockquote><p>Note that a declared type of &ldquo;FLOATING POINT&rdquo; would give INTEGER affinity, not REAL affinity, due to the &ldquo;INT&rdquo; at the end of &ldquo;POINT&rdquo;.</p></blockquote></li><li><p>This is one my <a href=https://x.com/iavins/status/1865746403072389612>favorite lore</a>. SQLite had to change the default prefix from <code>sqlite_</code> to <code>etilqs_</code> when users started calling developers in the middle of the night</p><img src=/blag/images/2024/sqlite-fact-9.png style=width:65%></li><li><p>SQLite takes backward compatibility very seriously</p><blockquote><p>All releases of SQLite version 3 can read and write database files created by the very first SQLite 3 release (version 3.0.0) going back to 2004-06-18. This is “backwards compatibility”. The developers promise to maintain backwards compatibility of the database file format for all future releases of SQLite 3.</p></blockquote></li><li><p>But they take backward compatibility so seriously that even if they have <a href=https://x.com/iavins/status/1851276312876326980>shipped a bug</a>, they won&rsquo;t fix it</p><img src=/blag/images/2024/sqlite-fact-10.png style=width:65%></li><li><p>SQLite&rsquo;s author D. Richard Hipp (DRH) did not find existing version control systems suitable. So he wrote his own called <a href=https://fossil-scm.org/home/doc/trunk/www/fossil-v-git.wiki>Fossil</a>. Fossil is powered by SQLite, of course.</p><p>This reminds me of how Linus wrote Git.</p><p>DRH also wrote his own parser generator called Lemon.</p></li><li><p>DRH wrote the B-Tree based on the algorithm in the book TAOCP by Donald Knuth, coding it on a plane while traveling (super based)</p></li><li><p>SQLite is pronounced as &ldquo;Ess-Cue-El-ite&rdquo;. There is no official guideline though. DRH mentioned in the <a href=https://web.archive.org/web/20201126110450/http://sqlite.1065341.n5.nabble.com/SQLite-Pronunciation-td88186.html#message88194>SQLite forums</a>:</p><blockquote><p>I wrote SQLite, and I think it should be pronounced &ldquo;S-Q-L-ite&rdquo;. Like a mineral. But I&rsquo;m cool with y&rsquo;all pronouncing it any way you want.</p><p>:-)</p></blockquote></li></ol><p>That&rsquo;s it for today! If I missed any, let me know. Happy holidays and Happy New Year! 🎄 ☃️</p><hr><p><small>1. Sources: <a href=https://www.sqlite.org/mostdeployed.html>Most Deployed</a>, <a href=https://www.sqlite.org/copyright.html>Public Domain and Contributions</a>, <a href=https://www.sqlite.org/testing.html>Testing</a>, <a href=https://www.sqlite.org/prosupport.html>Paid support</a>, <a href=https://www.sqlite.org/fasterthanfs.html>Faster than filesystem</a>, <a href=https://corecursive.com/066-sqlite-with-richard-hipp/>SQLite History</a>.</small><br><small>2. I posted this as thread on Twitter, where bunch of people provided more sources. Thanks to them: <a href=https://x.com/nomsolence/status/1873416106922402060>1</a>, <a href=https://x.com/motherwell/status/1873678651616829949>2</a>, <a href=https://x.com/eriklangille/status/1873737893057122400>3</a>, <a href=https://old.reddit.com/r/programming/comments/1hpowxh/collection_of_insane_and_fun_facts_about_sqlite/m4ktv35/>4</a>.</small><br><small>3. After following the discussions on Reddit and HN, I have rephrased the license section (#6). Previously, it read: <i>SQLite is not open source in the legal sense, as “open source” has a specific definition and requires licenses approved by the Open Source Initiative (OSI).</i></small></p></article><script async data-uid=0576bb9e32 src=https://avin.ck.page/0576bb9e32/index.js></script><footer class=site-footer><div class=rc-scout style=margin-right:auto;margin-top:auto;font-size:.6rem></div><script async defer src="https://www.recurse-scout.com/loader.js?t=a4aabd5087bb19daf083302de1b46650"></script><span class=person-schema itemscope itemtype=http://schema.org/Person><link itemprop=url href=https://avi.im/blag/><span itemprop=name></span><br><a itemprop=sameAs href=https://github.com/avinassh title=GitHub><img src=/blag/svg/gh.svg alt="icon name"></a>
<a itemprop=sameAs href=/blag/index.xml title=GitHub><img src=/blag/svg/rss.svg alt="icon name"></a></span></footer></div><script src=/blag/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script data-goatcounter=https://avi.goatcounter.com/count async src=//gc.zgo.at/count.js></script></body></html>